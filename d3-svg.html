<html>
<head>
<title>D3 Testing</title>
<link rel="stylesheet" type="text/css" href="style.css">
<script type="text/javascript" src="http://mbostock.github.com/d3/d3.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
</head>
<body>

	<div id="colors" class="debug"></div>

<script type="text/javascript">

	var svg = d3.select("body")
				.append("svg")
				.attr("width", 900)
				.attr("height", 500);

	function rgb2hsv () {
    var rr, gg, bb,
      r = arguments[0] / 255,
      g = arguments[1] / 255,
      b = arguments[2] / 255,
      h, s,
      v = Math.max(r, g, b),
      diff = v - Math.min(r, g, b),
      diffc = function(c){
        return (v - c) / 6 / diff + 1 / 2;
    };

    if (diff == 0) {
      h = s = 0;
    } else {
      s = diff / v;
      rr = diffc(r);
      gg = diffc(g);
      bb = diffc(b);

      if (r === v) {
        h = bb - gg;
      } else if (g === v) {
        h = (1 / 3) + rr - bb;
      } else if (b === v) {
        h = (2 / 3) + gg - rr;
      }
      if (h < 0) {
        h += 1;
      } else if (h > 1) {
        h -= 1;
      }
    }
    return {
      h: Math.round(h * 360),
      s: Math.round(s * 100),
      v: Math.round(v * 100)
    };
	}

	function hex2rgb (hex) {
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
    } : null;
	}

	var format = d3.time.format("%Y-%m-%d %X");
	var prevMonth = "";
	var currentMonth = "";

	pins = d3.csv("allpins.csv");

	svg.selectAll("rect")
   .data(pins)
   .enter()
   .append("rect")
   .attr("x", function(d, i) {
		return 5
   })
   .attr("y", function(d) {
		return 5
   })
   .attr("width", xScale.rangeBand())
   .attr("height", function(d) {
		return 5
   })
   .attr("fill", function(d) {
		return "rgb(0, 0, " + (d.value * 10) + ")";
   })

</script>
</body>
</html>